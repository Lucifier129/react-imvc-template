'use strict'

var index = require('./index')
var input = require('./input')
var inline = require('./inline')
var isInput = require('./isInput')

function core (elem, options) {
  var cal
  var existing = index.find(elem)
  if (existing) {
    return existing
  }

  if (isInput(elem)) {
    cal = input(elem, options)
  } else {
    cal = inline(elem, options)
  }
  index.assign(elem, cal)

  return cal
}

module.exports = core
